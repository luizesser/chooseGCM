<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>chooseGCM: A package for selecting General Circulation Models for Species Distribution Modeling in R • chooseGCM</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="chooseGCM: A package for selecting General Circulation Models for Species Distribution Modeling in R">
<meta name="description" content="This package is intended to help modelers to select General Circulation Models (GCMs) to project Species Distribution Models to future scenarios. The package uses clusterization to detect GCMs that are more different from one another, avoiding highly correlated GCMs.">
<meta property="og:description" content="This package is intended to help modelers to select General Circulation Models (GCMs) to project Species Distribution Models to future scenarios. The package uses clusterization to detect GCMs that are more different from one another, avoiding highly correlated GCMs.">
<meta property="og:image" content="https://luizesser.github.io/chooseGCM/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">chooseGCM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Resolution.html">Resolution</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="choosegcm-an-r-package-with-a-toolkit-to-select-general-circulation-models">chooseGCM: an R package with a toolkit to select General Circulation Models<a class="anchor" aria-label="anchor" href="#choosegcm-an-r-package-with-a-toolkit-to-select-general-circulation-models"></a>
</h1>
</div>
<!-- badges: start -->

</div>
<div class="section level1">
<h1 id="choosegcm-">chooseGCM 
<a class="anchor" aria-label="anchor" href="#choosegcm-"></a>
</h1>
<p>The goal of chooseGCM is to help researchers aiming to project Species Distribution Models and Ecological Niche Models to future scenarios by applying a selection routine to the General Circulation Models.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of chooseGCM from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"luizesser/chooseGCM"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h2>
<p>This is a basic tutorial which shows you how to use the functions in chooseGCM. After installing the package, we need to open it:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://luizesser.github.io/chooseGCM/">chooseGCM</a></span><span class="op">)</span></span>
<span><span class="fu">tictoc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="downloading-worldclim-21-data">Downloading WorldClim 2.1 Data<a class="anchor" aria-label="anchor" href="#downloading-worldclim-21-data"></a>
</h3>
<p>First, we need to use only one time period. Here we use 2090 so the difference between models is more conspicuous. In the same way we are considering the SSP585, which is the more dramatic pathway. The resolution is the lowest to be quicker. The aim here is to maintain all parameters equal, but General Circulation Models (GCMs). In this way we know that the only source of variation comes from them. Note that if you receive a timeout error you can increase timeout value by running , where 600 is the value in seconds that will be enough to download the data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/WorldClim_data.html">worldclim_data</a></span><span class="op">(</span>period <span class="op">=</span> <span class="st">"future"</span>, variable <span class="op">=</span> <span class="st">"bioc"</span>, year <span class="op">=</span> <span class="st">"2090"</span>, gcm <span class="op">=</span> <span class="st">"all"</span>, ssp <span class="op">=</span> <span class="st">"585"</span>, resolution <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="importing-and-transforming-data">Importing and Transforming Data<a class="anchor" aria-label="anchor" href="#importing-and-transforming-data"></a>
</h3>
<p>Now let’s import GCMs to R in a list of stacks and name the list with the names of the GCMs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/import_gcms.html">import_gcms</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_ssp585_10_2090"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In each function, data will be transformed. To do that you will always need to provide at least: (1) the list of stacks, (2) the variables you want to use in analysis and (3) the shapefile of your study area. You don’t need to previously mask and subset your data, once the functions will perform this task internally for you. Note that the results from these functions are highly sensitive to variables and to study area. In this sense, the decision on what variables should be considered and what is the study area must be carefully made considering biological aspects of the studied group.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bio5"</span>, <span class="st">"bio13"</span>, <span class="st">"bio15"</span><span class="op">)</span></span>
<span><span class="va">study_area_parana</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="st">"input_data/PR_UF_2022.shp"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="straigthforward-approach">Straigthforward Approach<a class="anchor" aria-label="anchor" href="#straigthforward-approach"></a>
</h3>
<p>There is the option to run each function in separate to better understand what is happening and to better parameterize each step. However there is a wrapper to help run everything at once and could be an alternative to have a broad perspective. <code><a href="reference/compare_gcms.html">compare_gcms()</a></code> will return a list with a vector called <code>suggested_gcms</code> and a Figure called <code>statistics_gcms</code>. We suggest that this Figure could also be included as it is in supplementary data from studies using this package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/compare_gcms.html">compare_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="co">#&gt; Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as</span></span>
<span><span class="co">#&gt; of ggplot2 3.3.4.</span></span>
<span><span class="co">#&gt; ℹ The deprecated feature was likely used in the factoextra package.</span></span>
<span><span class="co">#&gt;   Please report the issue at &lt;https://github.com/kassambara/factoextra/issues&gt;.</span></span>
<span><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span><span class="co">#&gt; generated.</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">statistics_gcms</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
<p>The aim of this function is to inform the minimum required so users can follow with their workflow in a more straightforward fashion (more on each plot further). If we see the D plot in the Figure, we can infer if the selected GCMs encompass the environmental variety of all GCMs. The focus should be to cover the core environment and not outlier regions on the environmental space. Above that, in plot B, the Monte Carlo permutation between GCMs is presented as a violin plot. Plots A and C are both clusterization methods that can be used to select GCMs. Clusterization will be adapted to the number of clusters <code>k</code> designated in the function. Lastly, suggested GCMs were “uk”, “ml” and “ac”. Those suggestions are the gcms that are closer to the centroid of each K-means cluster, thus they better represent the variation within each cluster.</p>
</div>
<div class="section level3">
<h3 id="deep-dive-approach">Deep-dive Approach<a class="anchor" aria-label="anchor" href="#deep-dive-approach"></a>
</h3>
<p>As an alternative for experienced modelers that want to deeply understand the impacts of decisions on GCMs selection, we prepared a set of functions to analyze data more carefully. Each function in the wrapper mentioned above is available to be explored as stand-alone, ranging from exploratory analysis to cluster analysis and methods to determine the optimum number of clusters.</p>
<div class="section level4">
<h4 id="exploratory-analysis">Exploratory Analysis<a class="anchor" aria-label="anchor" href="#exploratory-analysis"></a>
</h4>
<p>In chooseGCM we implemented functions to analyze GCMs attributes. <code>summary_gcms</code> is the only function available that describes variations within GCMs. It returns the internal information regarding each variable, as reads: minimum value (min), first quartile (quantile_0.25), second quartile (median), average (mean), third quartile (quantile_0.75), maximum value (max), standard deviation (sd), number of NAs (NAs) and the total number of cells (n_cells). This function returns a list of GCMs with a table associated with each of them.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary of GCMs</span></span>
<span><span class="va">s_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/summary_gcms.html">summary_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="va">s_sum</span></span>
<span><span class="co">#&gt; $ac</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   30.0        33.100  35.00  34.86172        36.600  38.9  2.074876   0</span></span>
<span><span class="co">#&gt; bio13 219.9       281.475 312.55 322.36596       367.075 447.1 49.906181   0</span></span>
<span><span class="co">#&gt; bio15  21.1        31.375  36.00  35.81045        40.000  52.8  6.702049   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ae</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   28.5         31.70   33.9  33.78263        35.800  39.0  2.457254   0</span></span>
<span><span class="co">#&gt; bio13 160.8        205.05  235.0 232.06681       253.825 346.4 33.968277   0</span></span>
<span><span class="co">#&gt; bio15  13.6         23.00   27.1  27.88164        32.400  49.9  7.270607   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ca</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   32.5        36.500  40.00  39.68842          42.8  45.8  3.514195   0</span></span>
<span><span class="co">#&gt; bio13 127.5       159.975 175.05 179.44336         196.3 257.1 24.683431   0</span></span>
<span><span class="co">#&gt; bio15  25.8        35.275  41.10  41.37500          46.7  63.0  8.097520   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cc</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   32.6        37.000  40.55  40.15946         43.20  46.2  3.572662   0</span></span>
<span><span class="co">#&gt; bio13 120.6       162.975 174.75 179.40975        190.85 259.9 22.865425   0</span></span>
<span><span class="co">#&gt; bio15  25.7        35.800  41.30  41.72189         46.80  64.0  8.117374   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ce</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   28.3        31.000  33.40  33.13842        35.200  37.6  2.403073   0</span></span>
<span><span class="co">#&gt; bio13 154.9       188.400 207.70 210.40833       228.425 352.4 30.119732   0</span></span>
<span><span class="co">#&gt; bio15  22.0        30.075  34.45  35.72034        39.700  61.8  7.868957   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ch</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   30.1        32.800  35.05  34.77429        36.800  38.2  2.234395   0</span></span>
<span><span class="co">#&gt; bio13 157.6       197.775 227.85 234.49393       265.825 349.1 42.809635   0</span></span>
<span><span class="co">#&gt; bio15  21.1        29.475  34.10  34.05184        37.600  50.8  6.025080   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cn</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   29.6        32.300  34.20  34.04647        35.900  37.8  2.027931   0</span></span>
<span><span class="co">#&gt; bio13 161.4       201.850 231.45 242.94816       284.025 365.6 50.184711   0</span></span>
<span><span class="co">#&gt; bio15  21.6        29.075  33.75  33.78065        37.800  50.2  5.937047   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cr</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   29.5        32.200  33.90  33.75946        35.400  37.4  1.883084   0</span></span>
<span><span class="co">#&gt; bio13 153.0       196.975 224.15 229.00833       258.900 324.9 38.503760   0</span></span>
<span><span class="co">#&gt; bio15  17.8        27.200  32.85  33.04746        37.925  52.0  7.394922   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ec</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   27.9        30.675   33.4  33.69082         36.50  40.5  3.351993   0</span></span>
<span><span class="co">#&gt; bio13 150.3       191.325  220.2 223.09661        250.45 346.0 38.320731   0</span></span>
<span><span class="co">#&gt; bio15  23.3        29.900   32.9  33.72924         37.40  48.7  5.068337   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ev</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   28.1        30.900  34.00  34.14223        37.100  40.9  3.463340   0</span></span>
<span><span class="co">#&gt; bio13 145.4       179.250 201.95 208.68517       233.375 360.9 37.829991   0</span></span>
<span><span class="co">#&gt; bio15  24.0        30.375  33.90  34.71398        37.925  52.0  5.387966   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fi</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   28.8        31.900   33.9  33.70833        35.500  38.4  2.115846   0</span></span>
<span><span class="co">#&gt; bio13 159.8       201.875  220.0 225.59816       249.950 337.8 31.579720   0</span></span>
<span><span class="co">#&gt; bio15  17.7        25.575   29.6  30.54816        34.125  52.2  6.641921   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gg</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   28.2        30.800   32.9  32.66977          34.5  36.6  2.085673   0</span></span>
<span><span class="co">#&gt; bio13 142.0       176.300  197.1 196.51299         213.4 318.6 24.392013   0</span></span>
<span><span class="co">#&gt; bio15  11.2        18.775   22.5  23.92542          27.7  46.7  7.175692   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gh</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   28.0          30.7  32.70  32.66201          34.6  36.5  2.203157   0</span></span>
<span><span class="co">#&gt; bio13 143.7         181.3 208.15 209.34831         237.4 298.2 31.727428   0</span></span>
<span><span class="co">#&gt; bio15  19.1          25.6  28.10  29.46328          32.8  50.2  5.975185   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hg</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   30.9         34.50   36.7  36.54675          38.7  41.1  2.422012   0</span></span>
<span><span class="co">#&gt; bio13 167.8        210.95  235.4 244.28701         275.6 379.1 41.653356   0</span></span>
<span><span class="co">#&gt; bio15  15.1         22.90   26.9  28.02090          31.9  48.7  6.589878   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ic</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   28.3          30.7  32.50  32.42048        34.000  36.4  1.904782   0</span></span>
<span><span class="co">#&gt; bio13 137.3         170.3 186.30 193.21328       213.925 298.1 28.865385   0</span></span>
<span><span class="co">#&gt; bio15  14.2          23.7  27.75  28.84816        33.100  51.6  7.323494   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`in`</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   28.4         30.80   32.5  32.48390        34.000  37.0  1.916037   0</span></span>
<span><span class="co">#&gt; bio13 144.7        184.70  199.9 202.81709       214.100 373.5 25.584168   0</span></span>
<span><span class="co">#&gt; bio15  13.6         23.55   28.0  28.86511        33.725  53.0  8.048436   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ip</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   29.5        32.775  35.85  35.53531        38.000  40.7  3.007477   0</span></span>
<span><span class="co">#&gt; bio13 146.1       181.250 194.60 197.31102       211.075 303.5 21.489514   0</span></span>
<span><span class="co">#&gt; bio15  15.5        26.300  32.80  33.45918        39.500  61.9  9.740520   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $me</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   27.3        29.600  31.40  31.35099         32.90  35.3  1.922350   0</span></span>
<span><span class="co">#&gt; bio13 146.2       178.975 199.95 204.60650        226.55 316.6 30.141320   0</span></span>
<span><span class="co">#&gt; bio15  15.0        25.900  28.80  29.88912         33.70  51.1  6.898089   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mi</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   29.4          32.0   33.1  33.08404        34.200  37.0  1.512676   0</span></span>
<span><span class="co">#&gt; bio13 156.9         190.6  209.2 215.32712       239.725 324.6 30.799656   0</span></span>
<span><span class="co">#&gt; bio15  16.5          25.9   29.3  29.75071        33.400  45.1  5.750529   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ml</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   28.1        30.500  32.30  32.26709        34.000  36.9  1.986405   0</span></span>
<span><span class="co">#&gt; bio13 141.3       173.250 188.75 190.07288       202.850 339.6 24.659868   0</span></span>
<span><span class="co">#&gt; bio15  18.0        28.475  33.00  34.32472        39.825  58.6  8.764426   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mp</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   28.0        30.300   32.0  32.00975        33.700  36.0  1.958004   0</span></span>
<span><span class="co">#&gt; bio13 150.3       189.200  208.4 210.17571       228.250 307.4 28.119429   0</span></span>
<span><span class="co">#&gt; bio15  15.0        25.375   29.4  30.96271        36.025  54.1  8.204866   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mr</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   27.9         30.40  32.10  31.95650        33.500  36.2  1.846094   0</span></span>
<span><span class="co">#&gt; bio13 167.5        210.45 243.45 244.38249       275.625 330.1 38.147684   0</span></span>
<span><span class="co">#&gt; bio15  17.9         26.30  32.30  32.15833        37.100  50.9  7.384676   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $uk</span></span>
<span><span class="co">#&gt;         min quantile_0.25 median      mean quantile_0.75   max        sd NAs</span></span>
<span><span class="co">#&gt; bio5   31.0         34.10  36.30  36.29322        38.425  41.5  2.521581   0</span></span>
<span><span class="co">#&gt; bio13 154.9        198.90 228.45 234.27839       267.700 379.0 44.507444   0</span></span>
<span><span class="co">#&gt; bio15  17.2         25.75  30.40  30.85268        35.400  49.4  6.709703   0</span></span>
<span><span class="co">#&gt;       n_cells</span></span>
<span><span class="co">#&gt; bio5      708</span></span>
<span><span class="co">#&gt; bio13     708</span></span>
<span><span class="co">#&gt; bio15     708</span></span></code></pre></div>
<p>Regarding the exploratory comparison between GCMs, two functions are available: <code>cor_gcms</code> and <code>dist_gcms</code>. The first is designed to return a list with a correlation matrix between GCMs and a plot of this matrix. We noticed while building this package that (as expected) Pearson correlation values are always very high, rarely reaching values bellow 0.95. In this way we found that this function could not be so informative and decided to present a distance function as seen bellow. However it is noteworthy that through this function the user can change the method used to obtain correlation values. See <code><a href="reference/cor_gcms.html">?cor_gcms</a></code> for available methods.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pearson Correlation between GCMs</span></span>
<span><span class="va">s_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cor_gcms.html">cor_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="co">#&gt; Scale for fill is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for fill, which will replace the existing scale.</span></span>
<span><span class="va">s_cor</span></span>
<span><span class="co">#&gt; $cor_matrix</span></span>
<span><span class="co">#&gt;           ac        ae        ca        cc        ce        ch        cn</span></span>
<span><span class="co">#&gt; ac 1.0000000 0.8222687 0.7474311 0.7774549 0.7167943 0.9268093 0.9705559</span></span>
<span><span class="co">#&gt; ae 0.8222687 1.0000000 0.9075920 0.8684687 0.9056885 0.8965440 0.8660992</span></span>
<span><span class="co">#&gt; ca 0.7474311 0.9075920 1.0000000 0.9521852 0.9178031 0.8053916 0.7686080</span></span>
<span><span class="co">#&gt; cc 0.7774549 0.8684687 0.9521852 1.0000000 0.8748224 0.8134863 0.7971570</span></span>
<span><span class="co">#&gt; ce 0.7167943 0.9056885 0.9178031 0.8748224 1.0000000 0.8312629 0.7644923</span></span>
<span><span class="co">#&gt; ch 0.9268093 0.8965440 0.8053916 0.8134863 0.8312629 1.0000000 0.9490186</span></span>
<span><span class="co">#&gt; cn 0.9705559 0.8660992 0.7686080 0.7971570 0.7644923 0.9490186 1.0000000</span></span>
<span><span class="co">#&gt; cr 0.9691325 0.8842913 0.8096930 0.8327782 0.7979551 0.9630363 0.9822591</span></span>
<span><span class="co">#&gt; ec 0.8343692 0.9127519 0.8020561 0.7876387 0.8074572 0.9011960 0.8806919</span></span>
<span><span class="co">#&gt; ev 0.8169534 0.9056375 0.8176688 0.8129450 0.8414429 0.9033529 0.8796525</span></span>
<span><span class="co">#&gt; fi 0.8569444 0.9222062 0.8706602 0.8629006 0.9037687 0.9076577 0.8968552</span></span>
<span><span class="co">#&gt; gg 0.8361983 0.9446917 0.8888227 0.8699211 0.9263903 0.8969800 0.8727610</span></span>
<span><span class="co">#&gt; gh 0.9095465 0.8323123 0.7526228 0.7742805 0.7357975 0.8831682 0.9156861</span></span>
<span><span class="co">#&gt; hg 0.8803762 0.9315005 0.8310857 0.8190898 0.8321600 0.9112541 0.9105055</span></span>
<span><span class="co">#&gt; ic 0.9054854 0.9192470 0.8788078 0.8766609 0.8760764 0.9474036 0.9280161</span></span>
<span><span class="co">#&gt; in 0.7282736 0.8899251 0.8582211 0.8718917 0.9011865 0.8105449 0.7691032</span></span>
<span><span class="co">#&gt; ip 0.6779757 0.8951112 0.9425874 0.9230164 0.9029984 0.7510189 0.7040445</span></span>
<span><span class="co">#&gt; me 0.8923514 0.9315303 0.8733456 0.8653210 0.8743066 0.9338734 0.9203804</span></span>
<span><span class="co">#&gt; mi 0.9337973 0.8932566 0.8100739 0.8231812 0.8117599 0.9402452 0.9421741</span></span>
<span><span class="co">#&gt; ml 0.7753140 0.9282318 0.8972975 0.8748226 0.9370699 0.8479921 0.8126015</span></span>
<span><span class="co">#&gt; mp 0.7947834 0.9473006 0.9215585 0.8696344 0.9364209 0.8622084 0.8305043</span></span>
<span><span class="co">#&gt; mr 0.9795831 0.7847647 0.7157671 0.7568350 0.6828909 0.9117137 0.9534145</span></span>
<span><span class="co">#&gt; uk 0.8668021 0.9425931 0.8568111 0.8376745 0.8446538 0.9187139 0.9032580</span></span>
<span><span class="co">#&gt;           cr        ec        ev        fi        gg        gh        hg</span></span>
<span><span class="co">#&gt; ac 0.9691325 0.8343692 0.8169534 0.8569444 0.8361983 0.9095465 0.8803762</span></span>
<span><span class="co">#&gt; ae 0.8842913 0.9127519 0.9056375 0.9222062 0.9446917 0.8323123 0.9315005</span></span>
<span><span class="co">#&gt; ca 0.8096930 0.8020561 0.8176688 0.8706602 0.8888227 0.7526228 0.8310857</span></span>
<span><span class="co">#&gt; cc 0.8327782 0.7876387 0.8129450 0.8629006 0.8699211 0.7742805 0.8190898</span></span>
<span><span class="co">#&gt; ce 0.7979551 0.8074572 0.8414429 0.9037687 0.9263903 0.7357975 0.8321600</span></span>
<span><span class="co">#&gt; ch 0.9630363 0.9011960 0.9033529 0.9076577 0.8969800 0.8831682 0.9112541</span></span>
<span><span class="co">#&gt; cn 0.9822591 0.8806919 0.8796525 0.8968552 0.8727610 0.9156861 0.9105055</span></span>
<span><span class="co">#&gt; cr 1.0000000 0.8776602 0.8724489 0.9098074 0.9079947 0.9211805 0.9140094</span></span>
<span><span class="co">#&gt; ec 0.8776602 1.0000000 0.9769223 0.8868706 0.8580796 0.8348469 0.9380815</span></span>
<span><span class="co">#&gt; ev 0.8724489 0.9769223 1.0000000 0.9062918 0.8722129 0.8188413 0.9419239</span></span>
<span><span class="co">#&gt; fi 0.9098074 0.8868706 0.9062918 1.0000000 0.9519619 0.8772080 0.9532942</span></span>
<span><span class="co">#&gt; gg 0.9079947 0.8580796 0.8722129 0.9519619 1.0000000 0.8811838 0.9099544</span></span>
<span><span class="co">#&gt; gh 0.9211805 0.8348469 0.8188413 0.8772080 0.8811838 1.0000000 0.8726213</span></span>
<span><span class="co">#&gt; hg 0.9140094 0.9380815 0.9419239 0.9532942 0.9099544 0.8726213 1.0000000</span></span>
<span><span class="co">#&gt; ic 0.9546310 0.8483330 0.8627452 0.9296029 0.9459835 0.8699525 0.9063314</span></span>
<span><span class="co">#&gt; in 0.8100512 0.7569568 0.7872102 0.8826283 0.9284360 0.7320099 0.8306961</span></span>
<span><span class="co">#&gt; ip 0.7559461 0.7610442 0.7798539 0.8325963 0.8884159 0.7182954 0.7899106</span></span>
<span><span class="co">#&gt; me 0.9459077 0.8525521 0.8606391 0.9276727 0.9555618 0.8781822 0.9111763</span></span>
<span><span class="co">#&gt; mi 0.9673688 0.8619600 0.8608742 0.9137696 0.9209719 0.8794114 0.9174088</span></span>
<span><span class="co">#&gt; ml 0.8521561 0.8134999 0.8414814 0.9292883 0.9662060 0.8059491 0.8796716</span></span>
<span><span class="co">#&gt; mp 0.8569821 0.8328734 0.8502194 0.9424687 0.9471829 0.8181316 0.8958994</span></span>
<span><span class="co">#&gt; mr 0.9639171 0.8059929 0.7903033 0.8414630 0.8243951 0.9301743 0.8539005</span></span>
<span><span class="co">#&gt; uk 0.9122260 0.9513474 0.9587427 0.9359819 0.9042681 0.8424736 0.9848288</span></span>
<span><span class="co">#&gt;           ic        in        ip        me        mi        ml        mp</span></span>
<span><span class="co">#&gt; ac 0.9054854 0.7282736 0.6779757 0.8923514 0.9337973 0.7753140 0.7947834</span></span>
<span><span class="co">#&gt; ae 0.9192470 0.8899251 0.8951112 0.9315303 0.8932566 0.9282318 0.9473006</span></span>
<span><span class="co">#&gt; ca 0.8788078 0.8582211 0.9425874 0.8733456 0.8100739 0.8972975 0.9215585</span></span>
<span><span class="co">#&gt; cc 0.8766609 0.8718917 0.9230164 0.8653210 0.8231812 0.8748226 0.8696344</span></span>
<span><span class="co">#&gt; ce 0.8760764 0.9011865 0.9029984 0.8743066 0.8117599 0.9370699 0.9364209</span></span>
<span><span class="co">#&gt; ch 0.9474036 0.8105449 0.7510189 0.9338734 0.9402452 0.8479921 0.8622084</span></span>
<span><span class="co">#&gt; cn 0.9280161 0.7691032 0.7040445 0.9203804 0.9421741 0.8126015 0.8305043</span></span>
<span><span class="co">#&gt; cr 0.9546310 0.8100512 0.7559461 0.9459077 0.9673688 0.8521561 0.8569821</span></span>
<span><span class="co">#&gt; ec 0.8483330 0.7569568 0.7610442 0.8525521 0.8619600 0.8134999 0.8328734</span></span>
<span><span class="co">#&gt; ev 0.8627452 0.7872102 0.7798539 0.8606391 0.8608742 0.8414814 0.8502194</span></span>
<span><span class="co">#&gt; fi 0.9296029 0.8826283 0.8325963 0.9276727 0.9137696 0.9292883 0.9424687</span></span>
<span><span class="co">#&gt; gg 0.9459835 0.9284360 0.8884159 0.9555618 0.9209719 0.9662060 0.9471829</span></span>
<span><span class="co">#&gt; gh 0.8699525 0.7320099 0.7182954 0.8781822 0.8794114 0.8059491 0.8181316</span></span>
<span><span class="co">#&gt; hg 0.9063314 0.8306961 0.7899106 0.9111763 0.9174088 0.8796716 0.8958994</span></span>
<span><span class="co">#&gt; ic 1.0000000 0.8999898 0.8308173 0.9892832 0.9655308 0.9151176 0.9152311</span></span>
<span><span class="co">#&gt; in 0.8999898 1.0000000 0.9025073 0.9086389 0.8676851 0.9544238 0.9068221</span></span>
<span><span class="co">#&gt; ip 0.8308173 0.9025073 1.0000000 0.8357345 0.7720280 0.9178104 0.8995446</span></span>
<span><span class="co">#&gt; me 0.9892832 0.9086389 0.8357345 1.0000000 0.9647568 0.9274873 0.9223096</span></span>
<span><span class="co">#&gt; mi 0.9655308 0.8676851 0.7720280 0.9647568 1.0000000 0.8871476 0.8759186</span></span>
<span><span class="co">#&gt; ml 0.9151176 0.9544238 0.9178104 0.9274873 0.8871476 1.0000000 0.9691976</span></span>
<span><span class="co">#&gt; mp 0.9152311 0.9068221 0.8995446 0.9223096 0.8759186 0.9691976 1.0000000</span></span>
<span><span class="co">#&gt; mr 0.8886704 0.7098175 0.6638051 0.8707488 0.9205766 0.7609427 0.7701088</span></span>
<span><span class="co">#&gt; uk 0.9158877 0.8344505 0.8072126 0.9200012 0.9172428 0.8817465 0.8961938</span></span>
<span><span class="co">#&gt;           mr        uk</span></span>
<span><span class="co">#&gt; ac 0.9795831 0.8668021</span></span>
<span><span class="co">#&gt; ae 0.7847647 0.9425931</span></span>
<span><span class="co">#&gt; ca 0.7157671 0.8568111</span></span>
<span><span class="co">#&gt; cc 0.7568350 0.8376745</span></span>
<span><span class="co">#&gt; ce 0.6828909 0.8446538</span></span>
<span><span class="co">#&gt; ch 0.9117137 0.9187139</span></span>
<span><span class="co">#&gt; cn 0.9534145 0.9032580</span></span>
<span><span class="co">#&gt; cr 0.9639171 0.9122260</span></span>
<span><span class="co">#&gt; ec 0.8059929 0.9513474</span></span>
<span><span class="co">#&gt; ev 0.7903033 0.9587427</span></span>
<span><span class="co">#&gt; fi 0.8414630 0.9359819</span></span>
<span><span class="co">#&gt; gg 0.8243951 0.9042681</span></span>
<span><span class="co">#&gt; gh 0.9301743 0.8424736</span></span>
<span><span class="co">#&gt; hg 0.8539005 0.9848288</span></span>
<span><span class="co">#&gt; ic 0.8886704 0.9158877</span></span>
<span><span class="co">#&gt; in 0.7098175 0.8344505</span></span>
<span><span class="co">#&gt; ip 0.6638051 0.8072126</span></span>
<span><span class="co">#&gt; me 0.8707488 0.9200012</span></span>
<span><span class="co">#&gt; mi 0.9205766 0.9172428</span></span>
<span><span class="co">#&gt; ml 0.7609427 0.8817465</span></span>
<span><span class="co">#&gt; mp 0.7701088 0.8961938</span></span>
<span><span class="co">#&gt; mr 1.0000000 0.8358686</span></span>
<span><span class="co">#&gt; uk 0.8358686 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cor_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%"></p>
<p>The function <code>dist_gcms</code> is very similar to the previous <code>cor_gcms</code>, but now for distances. This function has the same output: a list with two slots. One is the distance matrix obtained (<code>distances</code>), while the second is the plotted matrix (<code>heatmap</code>). Here the differences between GCMs are way more clear than in the previous plot. As in was it the previous function, methods can also be changed for a number of different distances. For a complete list of available methods see <code><a href="reference/dist_gcms.html">?dist_gcms</a></code>. To build a distance matrix considering multiple variables to each GCM we use a flattening strategy, where values are concatenated in one unique vector to each GCM. In the process, we need to scale variables so they end up with the same measure. This matrix is also used to calculate the clusters in the <code>compare_gcms</code> function and in further presented <code>kmeans_gcms</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Euclidean Distance between GCMs</span></span>
<span><span class="va">s_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dist_gcms.html">dist_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="va">s_dist</span></span>
<span><span class="co">#&gt; $distances</span></span>
<span><span class="co">#&gt;           ac        ae        ca        cc        ce        ch        cn</span></span>
<span><span class="co">#&gt; ae 27.457895                                                            </span></span>
<span><span class="co">#&gt; ca 32.732203 19.798860                                                  </span></span>
<span><span class="co">#&gt; cc 30.725172 23.621087 14.241854                                        </span></span>
<span><span class="co">#&gt; ce 34.660621 20.001733 18.672952 23.043507                              </span></span>
<span><span class="co">#&gt; ch 17.620294 20.948998 28.732019 28.128117 26.754119                    </span></span>
<span><span class="co">#&gt; cn 11.175950 23.832900 31.329937 29.333598 31.607333 14.705889          </span></span>
<span><span class="co">#&gt; cr 11.442906 22.154824 28.412712 26.633714 29.275833 12.521988  8.675084</span></span>
<span><span class="co">#&gt; ec 26.506714 19.238150 28.977199 30.013939 28.579129 20.472582 22.496777</span></span>
<span><span class="co">#&gt; ev 27.865456 20.007141 27.810948 28.168904 25.934520 20.247885 22.594555</span></span>
<span><span class="co">#&gt; fi 24.634157 18.165940 23.423478 24.115879 20.204291 19.791814 20.917458</span></span>
<span><span class="co">#&gt; gg 26.359949 15.317246 21.716675 23.490313 17.670668 20.904802 23.232477</span></span>
<span><span class="co">#&gt; gh 19.588360 26.670797 32.394042 30.943534 33.477561 22.262089 18.911886</span></span>
<span><span class="co">#&gt; hg 22.526522 17.046255 26.768161 27.702366 26.682906 19.402577 19.484241</span></span>
<span><span class="co">#&gt; ic 20.023255 18.508222 22.673719 22.873663 22.927799 14.937002 17.474431</span></span>
<span><span class="co">#&gt; in 33.950895 21.608741 24.523987 23.311700 20.473567 28.349045 31.296391</span></span>
<span><span class="co">#&gt; ip 36.959802 21.093560 15.605901 18.071093 20.284986 32.498892 35.432236</span></span>
<span><span class="co">#&gt; me 21.369263 17.042550 23.179037 23.902055 23.090934 16.748404 18.377875</span></span>
<span><span class="co">#&gt; mi 16.758037 21.279227 28.384267 27.387319 28.258000 15.921046 15.661970</span></span>
<span><span class="co">#&gt; ml 30.872612 17.448232 20.872570 23.043491 16.338584 25.393260 28.194756</span></span>
<span><span class="co">#&gt; mp 29.504725 14.951613 18.241404 23.516182 16.422628 24.176679 26.814186</span></span>
<span><span class="co">#&gt; mr  9.306375 30.216354 34.723419 32.117069 36.676655 19.352276 14.057585</span></span>
<span><span class="co">#&gt; uk 23.770265 15.605130 24.645638 26.240896 25.670581 18.569218 20.257831</span></span>
<span><span class="co">#&gt;           cr        ec        ev        fi        gg        gh        hg</span></span>
<span><span class="co">#&gt; ae                                                                      </span></span>
<span><span class="co">#&gt; ca                                                                      </span></span>
<span><span class="co">#&gt; cc                                                                      </span></span>
<span><span class="co">#&gt; ce                                                                      </span></span>
<span><span class="co">#&gt; ch                                                                      </span></span>
<span><span class="co">#&gt; cn                                                                      </span></span>
<span><span class="co">#&gt; cr                                                                      </span></span>
<span><span class="co">#&gt; ec 22.780809                                                            </span></span>
<span><span class="co">#&gt; ev 23.260949  9.894212                                                  </span></span>
<span><span class="co">#&gt; fi 19.560086 21.906508 19.937655                                        </span></span>
<span><span class="co">#&gt; gg 19.755666 24.536227 23.282458 14.275065                              </span></span>
<span><span class="co">#&gt; gh 18.285302 26.468458 27.721383 22.822875 22.450349                    </span></span>
<span><span class="co">#&gt; hg 19.099005 16.206729 15.695823 14.075731 19.544146 23.245220          </span></span>
<span><span class="co">#&gt; ic 13.872819 25.364769 24.129542 17.280753 15.137311 23.487476 19.933441</span></span>
<span><span class="co">#&gt; in 28.385959 32.109024 30.044207 22.313464 17.423388 33.716675 26.799015</span></span>
<span><span class="co">#&gt; ip 32.175715 31.837877 30.559121 26.648202 21.756368 34.568640 29.852961</span></span>
<span><span class="co">#&gt; me 15.147923 25.009482 24.313969 17.516066 13.729787 22.732162 19.411087</span></span>
<span><span class="co">#&gt; mi 11.765269 24.198469 24.293452 19.125616 18.309482 22.617182 18.717687</span></span>
<span><span class="co">#&gt; ml 25.043041 28.127092 25.931371 17.319323 11.973056 28.690830 22.592768</span></span>
<span><span class="co">#&gt; mp 24.630915 26.626136 25.206530 15.622025 14.968311 27.775635 21.014155</span></span>
<span><span class="co">#&gt; mr 12.371887 28.687594 29.825044 25.932873 27.293150 17.210474 24.894862</span></span>
<span><span class="co">#&gt; uk 19.296049 14.366086 13.229262 16.479221 20.151788 25.850089  8.022238</span></span>
<span><span class="co">#&gt;           ic        in        ip        me        mi        ml        mp</span></span>
<span><span class="co">#&gt; ae                                                                      </span></span>
<span><span class="co">#&gt; ca                                                                      </span></span>
<span><span class="co">#&gt; cc                                                                      </span></span>
<span><span class="co">#&gt; ce                                                                      </span></span>
<span><span class="co">#&gt; ch                                                                      </span></span>
<span><span class="co">#&gt; cn                                                                      </span></span>
<span><span class="co">#&gt; cr                                                                      </span></span>
<span><span class="co">#&gt; ec                                                                      </span></span>
<span><span class="co">#&gt; ev                                                                      </span></span>
<span><span class="co">#&gt; fi                                                                      </span></span>
<span><span class="co">#&gt; gg                                                                      </span></span>
<span><span class="co">#&gt; gh                                                                      </span></span>
<span><span class="co">#&gt; hg                                                                      </span></span>
<span><span class="co">#&gt; ic                                                                      </span></span>
<span><span class="co">#&gt; in 20.597166                                                            </span></span>
<span><span class="co">#&gt; ip 26.789418 20.336277                                                  </span></span>
<span><span class="co">#&gt; me  6.742450 19.686381 26.397241                                        </span></span>
<span><span class="co">#&gt; mi 12.092083 23.691342 31.097544 12.227094                              </span></span>
<span><span class="co">#&gt; ml 18.975546 13.904473 18.672125 17.538492 21.879667                    </span></span>
<span><span class="co">#&gt; mp 18.962846 19.881161 20.642960 18.153856 22.942395 11.430818          </span></span>
<span><span class="co">#&gt; mr 21.731544 35.084958 37.764252 23.415458 18.355224 31.844637 31.228167</span></span>
<span><span class="co">#&gt; uk 18.889262 26.500209 28.597273 18.421590 18.736489 22.397128 20.984422</span></span>
<span><span class="co">#&gt;           mr</span></span>
<span><span class="co">#&gt; ae          </span></span>
<span><span class="co">#&gt; ca          </span></span>
<span><span class="co">#&gt; cc          </span></span>
<span><span class="co">#&gt; ce          </span></span>
<span><span class="co">#&gt; ch          </span></span>
<span><span class="co">#&gt; cn          </span></span>
<span><span class="co">#&gt; cr          </span></span>
<span><span class="co">#&gt; ec          </span></span>
<span><span class="co">#&gt; ev          </span></span>
<span><span class="co">#&gt; fi          </span></span>
<span><span class="co">#&gt; gg          </span></span>
<span><span class="co">#&gt; gh          </span></span>
<span><span class="co">#&gt; hg          </span></span>
<span><span class="co">#&gt; ic          </span></span>
<span><span class="co">#&gt; in          </span></span>
<span><span class="co">#&gt; ip          </span></span>
<span><span class="co">#&gt; me          </span></span>
<span><span class="co">#&gt; mi          </span></span>
<span><span class="co">#&gt; ml          </span></span>
<span><span class="co">#&gt; mp          </span></span>
<span><span class="co">#&gt; mr          </span></span>
<span><span class="co">#&gt; uk 26.386464</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $heatmap</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="obtain-clusters">Obtain Clusters<a class="anchor" aria-label="anchor" href="#obtain-clusters"></a>
</h4>
<p>Clusters in chooseGCM are obtained through K-means, a unsupervised machine learning algorithm. K in this case is the number of GCMs the modeler wants to use in projections. As in the previous <code>dist_gcms</code> function, we can address different methods to obtain the distance matrix by changing the <code>method</code> argument. The K-means algorithm uses the distance matrix to obtain clusters, thus a deep analysis of distances using <code>dist_gcms</code> function could prove to be useful. As in <code>compare_gcms</code> function, this function returns the K-means plot and a set of suggested GCMs, i.e. the GCMs closer to the centroid of each clusters.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/kmeans_gcms.html">kmeans_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k <span class="op">=</span> <span class="fl">3</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt;    1    2    3 </span></span>
<span><span class="co">#&gt; "uk" "cr" "ml" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="100%"></p>
<p>Alternatively, instead of using distances, one could run the analysis with raw environmental data by not setting any value to method (note how axis change). As in the previous case, the function also returns GCMs that are closer to the centroids. Note however that the plot below has a cluster with two GCMs, thus both have the same distance from the centroid. In this case, the function randomly suggests one of them. To perform this analysis without a distance matrix, we use only the mean values of each variable selected. In this way, the variability within variables is not considered, as in the above solution. But we recognize that for some purpose it could be useful to have a plot with raw variables as axis as provided here.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/kmeans_gcms.html">kmeans_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "ic" "gh" "in"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="100%"></p>
<p>We can also obtain clusters through hierarchical clustering. In this case, however, the function doesn’t suggest any GCM. It is up to the user to define which GCMs are most suitable in this case. Hierarchical clustering is useful to visually inform the relationship between groups and could also be used to choose a number of clusters to build (together with metrics in the next section).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/hclust_gcms.html">hclust_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "gh" "fi" "ev"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dend_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="100%"></p>
<p>In this function we also provide a <code>n</code> argument to inform the amount of data to be used in the clustering. This proved valuable when using high resolution data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/hclust_gcms.html">hclust_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k <span class="op">=</span> <span class="fl">3</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "gh" "ml" "fi"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dend_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="number-of-clusters">Number of Clusters<a class="anchor" aria-label="anchor" href="#number-of-clusters"></a>
</h4>
<p>But how many clusters are good? There is three metrics implemented to understand that. All of them are a way to see the minimum amount of GCMs that are needed to encompass the variability in the whole set of GCMs. The three methods are implemented in the same function by adjusting the <code>method</code> argument. Within-cluster sum of squares (wss) calculates the internal variability within clusters. Our goal here is to search for the minimum amount of clusters that has the minimum amount of variability. This is shown in the graph were the line changes abruptly its direction (Number of clusters k = 3). As in the previous function, this function provides a <code>n</code> argument to inform the amount of data to be used in the clustering. Finally, one can also indicate the method to build clusters with the argument <code>clusters</code>. Available methods are ‘kmeans’ (standard) and ‘hclust’.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/optk_gcms.html">optk_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, cluster <span class="op">=</span> <span class="st">"kmeans"</span>, method <span class="op">=</span> <span class="st">"wss"</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-17-1.png" width="100%"></p>
<p>The Average Silhouette Width method, measures the mean distance from all individuals to the centroid of their own clusters, while comparing to other clusters. This is sometimes also referred as a metric of cluster quality (the higher the better). A number of clusters is the best when the distance from individuals within the cluster to its centroid is lower than the distance from individuals to other clusters centroid (maximizing the average silhouette width). In this method, the best number of clusters is marked with a dashed line (2 clusters).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/optk_gcms.html">optk_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, cluster <span class="op">=</span> <span class="st">"kmeans"</span>, method <span class="op">=</span> <span class="st">"silhouette"</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-18-1.png" width="100%"></p>
<p>Our last method is the Gap Statistics. As in the previous method, here the optimum number of clusters is showed with a dashed line (1 cluster). This method compares the variation within clusters with a set of null clusters build through Monte Carlo (“bootstrap”) sampling. Because of that, the gap statistics can take a longer time to run when compared to previous methods described here. Moreover, some parameters can be changed to improve the Monte Carlo process, such as: <code>nstart</code>, <code>K.max</code> and <code>B</code>, where <code>nstart</code> is the initial number of arrangements to be compared, <code>K.max</code> is the maximum number of clusters to be created and B is the number of bootstrap permutations.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/optk_gcms.html">optk_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, cluster <span class="op">=</span> <span class="st">"kmeans"</span>, method <span class="op">=</span> <span class="st">"gap_stat"</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="co">#&gt; Warning: did not converge in 10 iterations</span></span>
<span><span class="co">#&gt; Warning: did not converge in 10 iterations</span></span>
<span><span class="co">#&gt; Warning: did not converge in 10 iterations</span></span>
<span><span class="co">#&gt; Warning: did not converge in 10 iterations</span></span>
<span><span class="co">#&gt; Warning: did not converge in 10 iterations</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-19-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="monte-carlo-permutations">Monte Carlo permutations<a class="anchor" aria-label="anchor" href="#monte-carlo-permutations"></a>
</h4>
<p>An alternative way to analyse if the mean distance between GCMs is similar to the mean distance between all GCMs is to use the <code>montecarlo_gcms</code> function. This function will build a distance matrix (using <code>method</code> argument) and plot the mean distance between all GCMs as a blue line. Afterwards, it will run a Monte Carlo permutation to randomly choose a group size ranging from [2] and [total number of GCMs - 1] and randomly choose a subset of GCMs with that group size. The mean distance between the random set is obtained and ploted in a violin plot. Finally, the function accesses the mean distance between selected GCMs using the kmeans function in all possible values of <code>k</code> and plots it in red.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/montecarlo_gcms.html">montecarlo_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, perm <span class="op">=</span> <span class="fl">10000</span>, dist_method <span class="op">=</span> <span class="st">"euclidean"</span>, clustering_method <span class="op">=</span> <span class="st">"kmeans"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $montecarlo_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-20-1.png" width="100%"></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k2</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt;    1    2 </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; "cr" "ml" </span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k3</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt;    1    2    3 </span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; "uk" "ml" "cr" </span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k4</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4 </span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; "uk" "cr" "gg" "ca" </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k5</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; "ca" "ac" "uk" "gg" "ic" </span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k6</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6 </span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; "cr" "ml" "me" "mr" "ca" "uk" </span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k7</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7 </span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; "ca" "uk" "mr" "cr" "ml" "ic" "gg" </span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k8</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8 </span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="co">#&gt; "gg" "ca" "ml" "ec" "ic" "cr" "mr" "hg" </span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k9</span></span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9 </span></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a><span class="co">#&gt; "hg" "cr" "gg" "ca" "gh" "ic" "ec" "ml" "ac" </span></span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k10</span></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10 </span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a><span class="co">#&gt; "ca" "ml" "gg" "gh" "cr" "hg" "ic" "ce" "ec" "ac" </span></span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k11</span></span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11 </span></span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a><span class="co">#&gt; "ml" "gg" "ca" "gh" "in" "cr" "ec" "hg" "ic" "ce" "ac" </span></span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k12</span></span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12 </span></span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a><span class="co">#&gt; "ip" "ic" "in" "cr" "gg" "hg" "ml" "ca" "gh" "ec" "ce" "ac" </span></span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k13</span></span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13 </span></span>
<span id="cb18-49"><a href="#cb18-49" tabindex="-1"></a><span class="co">#&gt; "ec" "in" "ml" "ac" "ce" "ca" "ae" "gh" "hg" "ic" "cr" "ip" "fi" </span></span>
<span id="cb18-50"><a href="#cb18-50" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-51"><a href="#cb18-51" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k14</span></span>
<span id="cb18-52"><a href="#cb18-52" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14 </span></span>
<span id="cb18-53"><a href="#cb18-53" tabindex="-1"></a><span class="co">#&gt; "ch" "ce" "ca" "ml" "ae" "gh" "in" "ec" "hg" "ip" "ac" "fi" "ic" "cn" </span></span>
<span id="cb18-54"><a href="#cb18-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-55"><a href="#cb18-55" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k15</span></span>
<span id="cb18-56"><a href="#cb18-56" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15 </span></span>
<span id="cb18-57"><a href="#cb18-57" tabindex="-1"></a><span class="co">#&gt; "ec" "hg" "ae" "in" "ca" "mi" "fi" "ml" "ch" "ce" "ac" "gh" "ip" "cn" "ic" </span></span>
<span id="cb18-58"><a href="#cb18-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-59"><a href="#cb18-59" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k16</span></span>
<span id="cb18-60"><a href="#cb18-60" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 </span></span>
<span id="cb18-61"><a href="#cb18-61" tabindex="-1"></a><span class="co">#&gt; "fi" "hg" "gh" "ec" "ip" "ch" "mi" "in" "cn" "ac" "ic" "ml" "ca" "ce" "gg" "ae" </span></span>
<span id="cb18-62"><a href="#cb18-62" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-63"><a href="#cb18-63" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k17</span></span>
<span id="cb18-64"><a href="#cb18-64" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 </span></span>
<span id="cb18-65"><a href="#cb18-65" tabindex="-1"></a><span class="co">#&gt; "ic" "gh" "ec" "ml" "ce" "ac" "hg" "mi" "cn" "ch" "ca" "in" "ae" "fi" "gg" "cc" </span></span>
<span id="cb18-66"><a href="#cb18-66" tabindex="-1"></a><span class="co">#&gt;   17 </span></span>
<span id="cb18-67"><a href="#cb18-67" tabindex="-1"></a><span class="co">#&gt; "ip" </span></span>
<span id="cb18-68"><a href="#cb18-68" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-69"><a href="#cb18-69" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k18</span></span>
<span id="cb18-70"><a href="#cb18-70" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 </span></span>
<span id="cb18-71"><a href="#cb18-71" tabindex="-1"></a><span class="co">#&gt; "ch" "mp" "mi" "in" "hg" "ae" "ca" "ec" "ce" "ip" "fi" "cn" "gh" "ml" "ac" "ic" </span></span>
<span id="cb18-72"><a href="#cb18-72" tabindex="-1"></a><span class="co">#&gt;   17   18 </span></span>
<span id="cb18-73"><a href="#cb18-73" tabindex="-1"></a><span class="co">#&gt; "cc" "gg" </span></span>
<span id="cb18-74"><a href="#cb18-74" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-75"><a href="#cb18-75" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k19</span></span>
<span id="cb18-76"><a href="#cb18-76" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 </span></span>
<span id="cb18-77"><a href="#cb18-77" tabindex="-1"></a><span class="co">#&gt; "ip" "gh" "ca" "ec" "mi" "ac" "ce" "ch" "ae" "fi" "cn" "cr" "in" "ml" "mp" "gg" </span></span>
<span id="cb18-78"><a href="#cb18-78" tabindex="-1"></a><span class="co">#&gt;   17   18   19 </span></span>
<span id="cb18-79"><a href="#cb18-79" tabindex="-1"></a><span class="co">#&gt; "ic" "cc" "hg" </span></span>
<span id="cb18-80"><a href="#cb18-80" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-81"><a href="#cb18-81" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k20</span></span>
<span id="cb18-82"><a href="#cb18-82" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 </span></span>
<span id="cb18-83"><a href="#cb18-83" tabindex="-1"></a><span class="co">#&gt; "ip" "ec" "mi" "cc" "ch" "ae" "gg" "mp" "ac" "ic" "ca" "cr" "fi" "hg" "gh" "cn" </span></span>
<span id="cb18-84"><a href="#cb18-84" tabindex="-1"></a><span class="co">#&gt;   17   18   19   20 </span></span>
<span id="cb18-85"><a href="#cb18-85" tabindex="-1"></a><span class="co">#&gt; "ml" "in" "mr" "ce" </span></span>
<span id="cb18-86"><a href="#cb18-86" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-87"><a href="#cb18-87" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k21</span></span>
<span id="cb18-88"><a href="#cb18-88" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 </span></span>
<span id="cb18-89"><a href="#cb18-89" tabindex="-1"></a><span class="co">#&gt; "ip" "cr" "gh" "ev" "ca" "ae" "mi" "ml" "ch" "hg" "fi" "ce" "ec" "gg" "mp" "mr" </span></span>
<span id="cb18-90"><a href="#cb18-90" tabindex="-1"></a><span class="co">#&gt;   17   18   19   20   21 </span></span>
<span id="cb18-91"><a href="#cb18-91" tabindex="-1"></a><span class="co">#&gt; "cc" "cn" "in" "ac" "ic" </span></span>
<span id="cb18-92"><a href="#cb18-92" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-93"><a href="#cb18-93" tabindex="-1"></a><span class="co">#&gt; $suggested_gcms$k22</span></span>
<span id="cb18-94"><a href="#cb18-94" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 </span></span>
<span id="cb18-95"><a href="#cb18-95" tabindex="-1"></a><span class="co">#&gt; "ac" "gg" "ev" "mi" "ml" "ip" "ec" "ce" "cn" "ic" "cr" "ch" "fi" "gh" "ca" "ae" </span></span>
<span id="cb18-96"><a href="#cb18-96" tabindex="-1"></a><span class="co">#&gt;   17   18   19   20   21   22 </span></span>
<span id="cb18-97"><a href="#cb18-97" tabindex="-1"></a><span class="co">#&gt; "cc" "in" "uk" "mr" "mp" "hg"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="the-environment-covered-by-gcms-selection">The environment covered by GCMs selection<a class="anchor" aria-label="anchor" href="#the-environment-covered-by-gcms-selection"></a>
</h4>
<p>We also included in this package a function called <code>env_gcms</code>, which is able to project GCMs in the environmental space. With that, researchers are able to see the coverage of GCMs when comparing to all GCMs. It is also possible to see the density of GCMs using the <code>highlight=sum</code> as argument.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/env_gcms.html">env_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, highlight <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">suggested_gcms</span><span class="op">$</span><span class="va">k3</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-21-1.png" width="100%"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/env_gcms.html">env_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, highlight <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-22-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="a-greedy-algorithm-for-gcms-selection">A greedy algorithm for GCMs selection<a class="anchor" aria-label="anchor" href="#a-greedy-algorithm-for-gcms-selection"></a>
</h4>
<p>As a way to optimize GCMs selection, we implemented a greedy algorithm, which calculates the distance matrix between all GCMs and calculates the mean distance in the matrix (global mean distance). The algorithm selects a random pair of GCMs and test if adding any other GCM to that pair will drive the mean distance closer to the global mean. The algorithm stops when adding a new GCM does not return a mean distance closer to the global mean or when the distance reaches a minimum value (standard = 0.0000001).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/closestdist_gcms.html">closestdist_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "ae" "cc" "hg" "mi" "ec" "ml"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $best_mean_diff</span></span>
<span><span class="co">#&gt; [1] 3.028944e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $global_mean</span></span>
<span><span class="co">#&gt; [1] 22.5668</span></span></code></pre></div>
<p>We can also provide the value of k we want to use:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/closestdist_gcms.html">closestdist_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area_parana</span>, k<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRS from s and study_area are not identical. Reprojecting study area.</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "ae" "ce" "ch"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $best_mean_diff</span></span>
<span><span class="co">#&gt; [1] 0.001482039</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $global_mean</span></span>
<span><span class="co">#&gt; [1] 22.5668</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="wrapping-up">Wrapping Up<a class="anchor" aria-label="anchor" href="#wrapping-up"></a>
</h4>
<p>From our analysis, we can infer that something between two and three clusters is enough to inform regarding the environmental variation from given GCMs. In this way, if we use GCMs CNRM-ESM2-1 (cr), MPI-ESM1-2-LR (ml) and UKESM1-0-LL (uk) to project our models into future scenarios we would be able to inform a decent variation in our projections.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tictoc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; 45.645 sec elapsed</span></span></code></pre></div>
</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing chooseGCM</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Luíz Fernando Esser <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/luizesser/chooseGCM/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/luizesser/chooseGCM/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luíz Fernando Esser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
