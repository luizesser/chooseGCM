<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>README • chooseGCM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="README">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chooseGCM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/README.html">README</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/luizesser/chooseGCM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>README</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/luizesser/chooseGCM/blob/main/vignettes/README.Rmd" class="external-link"><code>vignettes/README.Rmd</code></a></small>
      <div class="d-none name"><code>README.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="choosegcm-an-r-package-with-a-toolkit-to-select-general-circulation-models">chooseGCM: an R package with a toolkit to select General Circulation
Models<a class="anchor" aria-label="anchor" href="#choosegcm-an-r-package-with-a-toolkit-to-select-general-circulation-models"></a>
</h2>
<!-- badges: start -->
<p><a href="https://github.com/luizesser/chooseGCM/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/luizesser/chooseGCM/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <!-- badges: end --></p>
</div>
<div class="section level2">
<h2 id="choosegcm">chooseGCM
<a href="https://luizesser.github.io/chooseGCM/"><img src="reference/figures/logo.png" align="right" height="138" alt="chooseGCM website"></a><a class="anchor" aria-label="anchor" href="#choosegcm"></a>
</h2>
<p>The goal of chooseGCM is to help researchers aiming to project
Species Distribution Models and Ecological Niche Models to future
scenarios by applying a selection routine to the General Circulation
Models.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the development version of chooseGCM from <a href="https://github.com/luizesser/chooseGCM" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"luizesser/chooseGCM"</span><span class="op">)</span></span></code></pre></div>
<p>The package is also available on CRAN. Users are able to install it
using the following code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"chooseGCM"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h3>
<p>This is a basic tutorial which shows you how to use the functions in
chooseGCM. After installing the package, we need to open it:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://luizesser.github.io/chooseGCM/">chooseGCM</a></span><span class="op">)</span></span>
<span><span class="fu">tictoc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="downloading-worldclim-2-1-data">Downloading WorldClim 2.1 Data<a class="anchor" aria-label="anchor" href="#downloading-worldclim-2-1-data"></a>
</h4>
<p>First, we need to use only one time period. Here we use 2090 so the
difference between models is more conspicuous. In the same way we are
considering the SSP585, which is the more dramatic pathway. The
resolution is the lowest to be quicker. The aim here is to maintain all
parameters equal, but General Circulation Models (GCMs). In this way we
know that the only source of variation comes from them. Note that if you
receive a timeout error you can increase timeout value by running ,
where 600 is the value in seconds that will be enough to download the
data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/WorldClim_data.html">worldclim_data</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"input_data/WorldClim_data_gcms_all"</span>, period <span class="op">=</span> <span class="st">"future"</span>, variable <span class="op">=</span> <span class="st">"bioc"</span>, year <span class="op">=</span> <span class="st">"2090"</span>, gcm <span class="op">=</span> <span class="st">"all"</span>, ssp <span class="op">=</span> <span class="st">"585"</span>, resolution <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="importing-and-transforming-data">Importing and Transforming Data<a class="anchor" aria-label="anchor" href="#importing-and-transforming-data"></a>
</h4>
<p>Now let’s import GCMs to R in a list of stacks and name the list with
the names of the GCMs.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bio_1"</span>, <span class="st">"bio_12"</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_gcms.html">import_gcms</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"chooseGCM"</span><span class="op">)</span>, var_names <span class="op">=</span> <span class="va">var_names</span><span class="op">)</span></span></code></pre></div>
<p>In each function, data will be transformed. To do that you will
always need to provide at least: (1) the list of stacks, (2) the
variables you want to use in analysis and (3) the shapefile of your
study area. You don’t need to previously mask and subset your data, once
the functions will perform this task internally for you. Note that the
results from these functions are highly sensitive to variables and to
study area. In this sense, the decision on what variables should be
considered and what is the study area must be carefully made considering
biological aspects of the studied group.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_area</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">80</span>, <span class="op">-</span><span class="fl">30</span>, <span class="op">-</span><span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span>crs<span class="op">=</span><span class="st">"epsg:4326"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="straigthforward-approach">Straigthforward Approach<a class="anchor" aria-label="anchor" href="#straigthforward-approach"></a>
</h4>
<p>There is the option to run each function in separate to better
understand what is happening and to better parameterize each step.
However there is a wrapper to help run everything at once and could be
an alternative to have a broad perspective. <code><a href="../reference/compare_gcms.html">compare_gcms()</a></code>
will return a list with a vector called <code>suggested_gcms</code> and
a Figure called <code>statistics_gcms</code>. We suggest that this
Figure could also be included as it is in supplementary data from
studies using this package.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_gcms.html">compare_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as</span></span>
<span><span class="co">#&gt; of ggplot2 3.3.4.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">factoextra</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/kassambara/factoextra/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">statistics_gcms</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>The aim of this function is to inform the minimum required so users
can follow with their workflow in a more straightforward fashion (more
on each plot further). If we see the D plot in the Figure, we can infer
if the selected GCMs reasonably encompass the environmental variety of
all GCMs. The focus should be to cover the core environment and not
outlier regions on the environmental space. In plot C, the Monte Carlo
permutation between GCMs is presented as a violin plot. Plots A and B
are both clusterization methods that can be used to select GCMs.
Clusterization will be adapted to the number of clusters <code>k</code>
designated in the function. Lastly, suggested GCMs were “ae”, “ch” and
“cr”. Those suggestions are the gcms that are closer to the mean
absolute distance from global, thus they better represent the variation
within the environmental space.</p>
</div>
<div class="section level4">
<h4 id="deep-dive-approach">Deep-dive Approach<a class="anchor" aria-label="anchor" href="#deep-dive-approach"></a>
</h4>
<p>As an alternative for experienced modelers that want to deeply
understand the impacts of decisions on GCMs selection, we prepared a set
of functions to analyze data more carefully. Each function in the
wrapper mentioned above is available to be explored as stand-alone,
ranging from exploratory analysis to cluster analysis and methods to
determine the optimum number of clusters.</p>
<div class="section level5">
<h5 id="exploratory-analysis">Exploratory Analysis<a class="anchor" aria-label="anchor" href="#exploratory-analysis"></a>
</h5>
<p>In chooseGCM we implemented functions to analyze GCMs attributes.
<code>summary_gcms</code> is the only function available that describes
variations within GCMs. It returns the internal information regarding
each variable, as reads: minimum value (min), first quartile
(quantile_0.25), second quartile (median), average (mean), third
quartile (quantile_0.75), maximum value (max), standard deviation (sd),
number of NAs (NAs) and the total number of cells (n_cells). This
function returns a list of GCMs with a table associated with each of
them.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary of GCMs</span></span>
<span><span class="va">s_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summary_gcms.html">summary_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span><span class="op">)</span></span>
<span><span class="va">s_sum</span></span>
<span><span class="co">#&gt; $ae</span></span>
<span><span class="co">#&gt;           min quantile_0.25    median       mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1   7.734      24.38925   30.4245   27.59028      32.15975   36.223</span></span>
<span><span class="co">#&gt; bio_12 13.387     865.08324 1282.8990 1307.64099    1661.11371 3153.833</span></span>
<span><span class="co">#&gt;                sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    6.555202   0     470</span></span>
<span><span class="co">#&gt; bio_12 658.375705   0     470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cc</span></span>
<span><span class="co">#&gt;           min quantile_0.25    median       mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1   9.632       27.3485   32.6475   30.03756      34.59025   37.114</span></span>
<span><span class="co">#&gt; bio_12 17.049      748.7095 1239.3800 1324.42981    1842.35349 3718.158</span></span>
<span><span class="co">#&gt;                sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    6.375763   0     470</span></span>
<span><span class="co">#&gt; bio_12 736.340840   0     470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ch</span></span>
<span><span class="co">#&gt;           min quantile_0.25   median       mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1   9.519       24.7940   30.745   27.86301      32.00825   33.721</span></span>
<span><span class="co">#&gt; bio_12 11.061      953.1217 1582.748 1561.86020    2079.47766 3962.162</span></span>
<span><span class="co">#&gt;                sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    5.813717   0     470</span></span>
<span><span class="co">#&gt; bio_12 800.308736   0     470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cr</span></span>
<span><span class="co">#&gt;           min quantile_0.25    median       mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1   8.963      24.57275   30.8235   27.76396       32.3655   34.225</span></span>
<span><span class="co">#&gt; bio_12 10.892     940.39249 1437.9115 1431.00430     1853.5811 3904.810</span></span>
<span><span class="co">#&gt;                sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    6.226339   0     470</span></span>
<span><span class="co">#&gt; bio_12 717.373064   0     470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ev</span></span>
<span><span class="co">#&gt;          min quantile_0.25    median       mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1  9.135      24.09275   29.9925   27.10791      31.32125   33.478</span></span>
<span><span class="co">#&gt; bio_12 8.491     927.21727 1518.8020 1495.06446    1995.87979 3329.857</span></span>
<span><span class="co">#&gt;                sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    5.925051   0     470</span></span>
<span><span class="co">#&gt; bio_12 749.026990   0     470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gg</span></span>
<span><span class="co">#&gt;           min quantile_0.25   median       mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1   8.072      23.73725   29.465   26.57517        30.865   32.873</span></span>
<span><span class="co">#&gt; bio_12 13.857     983.01001 1629.942 1522.41924      1955.706 3891.572</span></span>
<span><span class="co">#&gt;                sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    5.928956   0     470</span></span>
<span><span class="co">#&gt; bio_12 727.476365   0     470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hg</span></span>
<span><span class="co">#&gt;           min quantile_0.25    median       mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1  10.346      26.00875   32.2665   29.63256      34.93375   37.080</span></span>
<span><span class="co">#&gt; bio_12 10.447     899.70450 1414.8480 1423.15330    1762.83701 3694.793</span></span>
<span><span class="co">#&gt;               sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    6.74503   0     470</span></span>
<span><span class="co">#&gt; bio_12 758.12557   0     470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`in`</span></span>
<span><span class="co">#&gt;           min quantile_0.25   median       mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1   7.136       23.0155   28.138   25.25642        29.269   30.790</span></span>
<span><span class="co">#&gt; bio_12 14.053      905.7955 1648.554 1642.04464      2330.816 3754.984</span></span>
<span><span class="co">#&gt;                sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    5.694216   0     470</span></span>
<span><span class="co">#&gt; bio_12 872.713168   0     470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $me</span></span>
<span><span class="co">#&gt;           min quantile_0.25    median      mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1   6.926       22.8935   28.7935   25.8296       30.1795   32.280</span></span>
<span><span class="co">#&gt; bio_12 12.646      924.1427 1524.8660 1549.1119     2004.8098 3736.639</span></span>
<span><span class="co">#&gt;                sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    5.949899   0     470</span></span>
<span><span class="co">#&gt; bio_12 848.705135   0     470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ml</span></span>
<span><span class="co">#&gt;          min quantile_0.25    median       mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1  7.324      23.94325   29.1495   26.45857       30.6025   33.174</span></span>
<span><span class="co">#&gt; bio_12 8.940     885.25952 1498.8890 1462.32763     1928.1500 3534.142</span></span>
<span><span class="co">#&gt;                sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    5.986042   0     470</span></span>
<span><span class="co">#&gt; bio_12 749.279630   0     470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mr</span></span>
<span><span class="co">#&gt;           min quantile_0.25    median       mean quantile_0.75      max</span></span>
<span><span class="co">#&gt; bio_1   7.992       23.5035   28.8605   26.03051       30.0505   32.220</span></span>
<span><span class="co">#&gt; bio_12 12.032      998.1548 1620.2320 1559.82805     2049.5742 3386.632</span></span>
<span><span class="co">#&gt;                sd NAs n_cells</span></span>
<span><span class="co">#&gt; bio_1    5.666088   0     470</span></span>
<span><span class="co">#&gt; bio_12 770.164184   0     470</span></span></code></pre></div>
<p>Regarding the exploratory comparison between GCMs, two functions are
available: <code>cor_gcms</code> and <code>dist_gcms</code>. The first
is designed to return a list with a correlation matrix between GCMs and
a plot of this matrix. We noticed while building this package that (as
expected) Pearson correlation values are always very high, rarely
reaching values bellow 0.95. In this way we found that this function
could not be so informative and decided to present a distance function
as seen bellow. However it is noteworthy that through this function the
user can change the method used to obtain correlation values. See
<code><a href="../reference/cor_gcms.html">?cor_gcms</a></code> for available methods.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pearson Correlation between GCMs</span></span>
<span><span class="va">s_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_gcms.html">cor_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span>
<span><span class="va">s_cor</span></span>
<span><span class="co">#&gt; $cor_matrix</span></span>
<span><span class="co">#&gt;           ae        cc        ch        cr        ev        gg        hg</span></span>
<span><span class="co">#&gt; ae 1.0000000 0.9219747 0.9571112 0.9613585 0.9492778 0.9649294 0.9833486</span></span>
<span><span class="co">#&gt; cc 0.9219747 1.0000000 0.9695970 0.9644769 0.9719578 0.9560660 0.9366215</span></span>
<span><span class="co">#&gt; ch 0.9571112 0.9695970 1.0000000 0.9910983 0.9867315 0.9825975 0.9693717</span></span>
<span><span class="co">#&gt; cr 0.9613585 0.9644769 0.9910983 1.0000000 0.9823423 0.9826507 0.9722321</span></span>
<span><span class="co">#&gt; ev 0.9492778 0.9719578 0.9867315 0.9823423 1.0000000 0.9773964 0.9546606</span></span>
<span><span class="co">#&gt; gg 0.9649294 0.9560660 0.9825975 0.9826507 0.9773964 1.0000000 0.9652498</span></span>
<span><span class="co">#&gt; hg 0.9833486 0.9366215 0.9693717 0.9722321 0.9546606 0.9652498 1.0000000</span></span>
<span><span class="co">#&gt; in 0.9314944 0.9681631 0.9849882 0.9734534 0.9807411 0.9793463 0.9425552</span></span>
<span><span class="co">#&gt; me 0.9556262 0.9642517 0.9886974 0.9832545 0.9796424 0.9783986 0.9652108</span></span>
<span><span class="co">#&gt; ml 0.9449743 0.9614685 0.9805508 0.9795914 0.9738266 0.9838261 0.9595722</span></span>
<span><span class="co">#&gt; mr 0.9588276 0.9588638 0.9901494 0.9814043 0.9816382 0.9860674 0.9646367</span></span>
<span><span class="co">#&gt;           in        me        ml        mr</span></span>
<span><span class="co">#&gt; ae 0.9314944 0.9556262 0.9449743 0.9588276</span></span>
<span><span class="co">#&gt; cc 0.9681631 0.9642517 0.9614685 0.9588638</span></span>
<span><span class="co">#&gt; ch 0.9849882 0.9886974 0.9805508 0.9901494</span></span>
<span><span class="co">#&gt; cr 0.9734534 0.9832545 0.9795914 0.9814043</span></span>
<span><span class="co">#&gt; ev 0.9807411 0.9796424 0.9738266 0.9816382</span></span>
<span><span class="co">#&gt; gg 0.9793463 0.9783986 0.9838261 0.9860674</span></span>
<span><span class="co">#&gt; hg 0.9425552 0.9652108 0.9595722 0.9646367</span></span>
<span><span class="co">#&gt; in 1.0000000 0.9822258 0.9778581 0.9859656</span></span>
<span><span class="co">#&gt; me 0.9822258 1.0000000 0.9806899 0.9883747</span></span>
<span><span class="co">#&gt; ml 0.9778581 0.9806899 1.0000000 0.9846096</span></span>
<span><span class="co">#&gt; mr 0.9859656 0.9883747 0.9846096 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cor_plot</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>The function <code>dist_gcms</code> is very similar to the previous
<code>cor_gcms</code>, but now for distances. This function has the same
output: a list with two slots. One is the distance matrix obtained
(<code>distances</code>), while the second is the plotted matrix
(<code>heatmap</code>). Here the differences between GCMs are way more
clear than in the previous plot. As in was it the previous function,
methods can also be changed for a number of different distances. For a
complete list of available methods see <code><a href="../reference/dist_gcms.html">?dist_gcms</a></code>. To build
a distance matrix considering multiple variables to each GCM we use a
flattening strategy, where values are concatenated in one unique vector
to each GCM. In the process, we need to scale variables so they end up
with the same measure. This matrix is also used to calculate the
clusters in the <code>compare_gcms</code> function and in further
presented <code>kmeans_gcms</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Euclidean Distance between GCMs</span></span>
<span><span class="va">s_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dist_gcms.html">dist_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="va">s_dist</span></span>
<span><span class="co">#&gt; $distances</span></span>
<span><span class="co">#&gt;           ae        cc        ch        cr        ev        gg        hg</span></span>
<span><span class="co">#&gt; cc 12.098570                                                            </span></span>
<span><span class="co">#&gt; ch  8.969913  7.552224                                                  </span></span>
<span><span class="co">#&gt; cr  8.514195  8.163410  4.086509                                        </span></span>
<span><span class="co">#&gt; ev  9.754736  7.253076  4.989154  5.755512                              </span></span>
<span><span class="co">#&gt; gg  8.111254  9.078551  5.713758  5.705027  6.511863                    </span></span>
<span><span class="co">#&gt; hg  5.589097 10.904037  7.580155  7.217513  9.222617  8.074113          </span></span>
<span><span class="co">#&gt; in 11.336510  7.728264  5.306804  7.057019  6.010795  6.224649 10.381061</span></span>
<span><span class="co">#&gt; me  9.123887  8.189250  4.604741  5.604862  6.179877  6.365865  8.078647</span></span>
<span><span class="co">#&gt; ml 10.160126  8.502065  6.040417  6.187604  7.007226  5.508376  8.708759</span></span>
<span><span class="co">#&gt; mr  8.788592  8.784732  4.298812  5.906397  5.869130  5.112497  8.145027</span></span>
<span><span class="co">#&gt;           in        me        ml</span></span>
<span><span class="co">#&gt; cc                              </span></span>
<span><span class="co">#&gt; ch                              </span></span>
<span><span class="co">#&gt; cr                              </span></span>
<span><span class="co">#&gt; ev                              </span></span>
<span><span class="co">#&gt; gg                              </span></span>
<span><span class="co">#&gt; hg                              </span></span>
<span><span class="co">#&gt; in                              </span></span>
<span><span class="co">#&gt; me  5.774464                    </span></span>
<span><span class="co">#&gt; ml  6.445012  6.018782          </span></span>
<span><span class="co">#&gt; mr  5.131127  4.670026  5.373297</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $heatmap</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="obtain-clusters">Obtain Clusters<a class="anchor" aria-label="anchor" href="#obtain-clusters"></a>
</h5>
<p>Clusters in chooseGCM are obtained through K-means, a unsupervised
machine learning algorithm. K in this case is the number of GCMs the
modeler wants to use in projections. As in the previous
<code>dist_gcms</code> function, we can address different methods to
obtain the distance matrix by changing the <code>method</code> argument.
The K-means algorithm uses the distance matrix to obtain clusters, thus
a deep analysis of distances using <code>dist_gcms</code> function could
prove to be useful. As in <code>compare_gcms</code> function, this
function returns the K-means plot and a set of suggested GCMs, i.e. the
GCMs closer to the centroid of each clusters.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/kmeans_gcms.html">kmeans_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, k <span class="op">=</span> <span class="fl">3</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt;    1    2    3 </span></span>
<span><span class="co">#&gt; "ae" "cc" "ch" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_plot</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>Alternatively, instead of using distances, one could run the analysis
with raw environmental data by not setting any value to method (note how
axis change). As in the previous case, the function also returns GCMs
that are closer to the centroids. Note however that the plot below has a
cluster with two GCMs, thus both have the same distance from the
centroid. In this case, the function randomly suggests one of them. To
perform this analysis without a distance matrix, we use only the mean
values of each variable selected. In this way, the variability within
variables is not considered, as in the above solution. But we recognize
that for some purpose it could be useful to have a plot with raw
variables as axis as provided here.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/kmeans_gcms.html">kmeans_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "in" "ch" "ev"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_plot</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>We can also obtain clusters through hierarchical clustering. In this
case, however, the function doesn’t suggest any GCM. It is up to the
user to define which GCMs are most suitable in this case. Hierarchical
clustering is useful to visually inform the relationship between groups
and could also be used to choose a number of clusters to build (together
with metrics in the next section).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hclust_gcms.html">hclust_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "hg" "cc" "cr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dend_plot</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>In this function we also provide a <code>n</code> argument to inform
the amount of data to be used in the clustering. This proved valuable
when using high resolution data.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hclust_gcms.html">hclust_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, k <span class="op">=</span> <span class="fl">3</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "hg" "cc" "cr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dend_plot</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="number-of-clusters">Number of Clusters<a class="anchor" aria-label="anchor" href="#number-of-clusters"></a>
</h5>
<p>But how many clusters are good? There is three metrics implemented to
understand that. All of them are a way to see the minimum amount of GCMs
that are needed to encompass the variability in the whole set of GCMs.
The three methods are implemented in the same function by adjusting the
<code>method</code> argument. Within-cluster sum of squares (wss)
calculates the internal variability within clusters. Our goal here is to
search for the minimum amount of clusters that has the minimum amount of
variability. This is shown in the graph were the line changes abruptly
its direction (Number of clusters k = 3). As in the previous function,
this function provides a <code>n</code> argument to inform the amount of
data to be used in the clustering. Finally, one can also indicate the
method to build clusters with the argument <code>clusters</code>.
Available methods are ‘kmeans’ (standard) and ‘hclust’.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/optk_gcms.html">optk_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, cluster <span class="op">=</span> <span class="st">"kmeans"</span>, method <span class="op">=</span> <span class="st">"wss"</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>The Average Silhouette Width method, measures the mean distance from
all individuals to the centroid of their own clusters, while comparing
to other clusters. This is sometimes also referred as a metric of
cluster quality (the higher the better). A number of clusters is the
best when the distance from individuals within the cluster to its
centroid is lower than the distance from individuals to other clusters
centroid (maximizing the average silhouette width). In this method, the
best number of clusters is marked with a dashed line (2 clusters).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/optk_gcms.html">optk_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, cluster <span class="op">=</span> <span class="st">"kmeans"</span>, method <span class="op">=</span> <span class="st">"silhouette"</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>Our last method is the Gap Statistics. As in the previous method,
here the optimum number of clusters is showed with a dashed line (1
cluster). This method compares the variation within clusters with a set
of null clusters build through Monte Carlo (“bootstrap”) sampling.
Because of that, the gap statistics can take a longer time to run when
compared to previous methods described here. Moreover, some parameters
can be changed to improve the Monte Carlo process, such as:
<code>nstart</code>, <code>K.max</code> and <code>B</code>, where
<code>nstart</code> is the initial number of arrangements to be
compared, <code>K.max</code> is the maximum number of clusters to be
created and B is the number of bootstrap permutations.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/optk_gcms.html">optk_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, cluster <span class="op">=</span> <span class="st">"kmeans"</span>, method <span class="op">=</span> <span class="st">"gap_stat"</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="monte-carlo-permutations">Monte Carlo permutations<a class="anchor" aria-label="anchor" href="#monte-carlo-permutations"></a>
</h5>
<p>An alternative way to analyse if the mean distance between GCMs is
similar to the mean distance between all GCMs is to use the
<code>montecarlo_gcms</code> function. This function will build a
distance matrix (using <code>method</code> argument) and plot the mean
distance between all GCMs as a blue line. Afterwards, it will run a
Monte Carlo permutation to randomly choose a group size ranging from [2]
and [total number of GCMs - 1] and randomly choose a subset of GCMs with
that group size. The mean distance between the random set is obtained
and ploted in a violin plot. Finally, the function accesses the mean
distance between selected GCMs using the kmeans function in all possible
values of <code>k</code> and plots it in red.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/montecarlo_gcms.html">montecarlo_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, perm <span class="op">=</span> <span class="fl">10000</span>, dist_method <span class="op">=</span> <span class="st">"euclidean"</span>, clustering_method <span class="op">=</span> <span class="st">"kmeans"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $montecarlo_plot</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; $suggested_gcms$k2</span></span>
<span><span class="co">#&gt;    1    2 </span></span>
<span><span class="co">#&gt; "ae" "ch" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k3</span></span>
<span><span class="co">#&gt;    1    2    3 </span></span>
<span><span class="co">#&gt; "ae" "cc" "ch" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k4</span></span>
<span><span class="co">#&gt;    1    2    3    4 </span></span>
<span><span class="co">#&gt; "ch" "ae" "ev" "cc" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k5</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; "ev" "gg" "ch" "ae" "cc" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k6</span></span>
<span><span class="co">#&gt;    1    2    3    4    5    6 </span></span>
<span><span class="co">#&gt; "ev" "ae" "in" "gg" "ch" "cc" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k7</span></span>
<span><span class="co">#&gt;    1    2    3    4    5    6    7 </span></span>
<span><span class="co">#&gt; "ev" "gg" "cc" "in" "ch" "me" "ae" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k8</span></span>
<span><span class="co">#&gt;    1    2    3    4    5    6    7    8 </span></span>
<span><span class="co">#&gt; "ae" "me" "cc" "hg" "ev" "in" "ch" "gg" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k9</span></span>
<span><span class="co">#&gt;    1    2    3    4    5    6    7    8    9 </span></span>
<span><span class="co">#&gt; "in" "ae" "gg" "ev" "cc" "ch" "me" "ml" "hg" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k10</span></span>
<span><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10 </span></span>
<span><span class="co">#&gt; "in" "ae" "mr" "gg" "ml" "ch" "me" "ev" "hg" "cc"</span></span></code></pre>
<p>An alternative is to use the <code>montecarlo_gcms</code> function
with the <code>clustering_method</code> argument set to
<code>closestdist</code>. This method will use a greedy algorithm to
select the GCMs that are closer to the global mean distance. The
algorithm stops when adding a new GCM does not return a mean distance
closer to the global mean or when the distance reaches a minimum value
(standard = 0.0000001).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/montecarlo_gcms.html">montecarlo_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, perm <span class="op">=</span> <span class="fl">10000</span>, dist_method <span class="op">=</span> <span class="st">"euclidean"</span>, clustering_method <span class="op">=</span> <span class="st">"closestdist"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $montecarlo_plot</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; $suggested_gcms$k2</span></span>
<span><span class="co">#&gt; [1] "cr" "hg"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k3</span></span>
<span><span class="co">#&gt; [1] "ae" "ch" "cr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k4</span></span>
<span><span class="co">#&gt; [1] "cc" "ev" "me" "ml"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k5</span></span>
<span><span class="co">#&gt; [1] "ae" "me" "mr" "cr" "in"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k6</span></span>
<span><span class="co">#&gt; [1] "ae" "ch" "cr" "ml" "ev" "in"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k7</span></span>
<span><span class="co">#&gt; [1] "ch" "mr" "ae" "hg" "ev" "gg" "in"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k8</span></span>
<span><span class="co">#&gt; [1] "cc" "ev" "me" "ml" "gg" "in" "hg" "mr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k9</span></span>
<span><span class="co">#&gt; [1] "ae" "cc" "hg" "cr" "ch" "me" "mr" "gg" "ev"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $suggested_gcms$k10</span></span>
<span><span class="co">#&gt;  [1] "ae" "cc" "hg" "cr" "ch" "me" "mr" "gg" "ev" "ml"</span></span></code></pre>
<p>The plot shows the mean distance between all GCMs as a blue line, the
mean distance between selected GCMs using the Closestdist algorithm in
all possible values of <code>k</code> as a red line and the mean
distance between random GCMs as a violin plot.</p>
</div>
<div class="section level5">
<h5 id="the-environment-covered-by-gcms-selection">The environment covered by GCMs selection<a class="anchor" aria-label="anchor" href="#the-environment-covered-by-gcms-selection"></a>
</h5>
<p>We also included in this package a function called
<code>env_gcms</code>, which is able to project GCMs in the
environmental space. With that, researchers are able to see the coverage
of GCMs when comparing to all GCMs. It is also possible to see the
density of GCMs using the <code>highlight=sum</code> as argument.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/env_gcms.html">env_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, highlight <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">suggested_gcms</span><span class="op">$</span><span class="va">k3</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/env_gcms.html">env_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, highlight <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="a-greedy-algorithm-for-gcms-selection">A greedy algorithm for GCMs selection<a class="anchor" aria-label="anchor" href="#a-greedy-algorithm-for-gcms-selection"></a>
</h5>
<p>As a way to optimize GCMs selection, we implemented a greedy
algorithm, which calculates the distance matrix between all GCMs and
calculates the mean distance in the matrix (global mean distance). The
algorithm selects a random pair of GCMs and test if adding any other GCM
to that pair will drive the mean distance closer to the global mean. The
algorithm stops when adding a new GCM does not return a mean distance
closer to the global mean or when the distance reaches a minimum value
(standard = 0.0000001).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/closestdist_gcms.html">closestdist_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span><span class="op">)</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "ae" "ch" "cr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $best_mean_diff</span></span>
<span><span class="co">#&gt; [1] 0.0001577513</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $global_mean</span></span>
<span><span class="co">#&gt; [1] 7.190363</span></span></code></pre></div>
<p>We can also provide the value of k we want to use:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/closestdist_gcms.html">closestdist_gcms</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">var_names</span>, <span class="va">study_area</span>, k<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; $suggested_gcms</span></span>
<span><span class="co">#&gt; [1] "ae" "ch" "cr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $best_mean_diff</span></span>
<span><span class="co">#&gt; [1] 0.0001577513</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $global_mean</span></span>
<span><span class="co">#&gt; [1] 7.190363</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="wrapping-up">Wrapping Up<a class="anchor" aria-label="anchor" href="#wrapping-up"></a>
</h5>
<p>From our analysis, we can infer that something between two and three
clusters is enough to inform regarding the environmental variation from
given GCMs. In this way, if we use GCMs ACCESS-ESM1-5 (ae),
CNRM-CM6-1-HR (ch) and CNRM-ESM2-1 (cr) to project our models into
future scenarios we would be able to inform a decent variation in our
projections.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tictoc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; 35.735 sec elapsed</span></span></code></pre></div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dayani Bailly, Reginaldo Ré, Marcos R. Lima, Luíz Esser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
